Example 1 of https://docs.google.com/document/d/1HiDj2OhtJQrtxIueJT_eTDPIPJL5C6ARkuPgoD-PV2c.

Note that with B > 3 as a reset condition, we are subjected to floating point precision issues.
